(this.webpackJsonpchatter=this.webpackJsonpchatter||[]).push([[11],{50:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var s=a(38),i=a(36),n=a(33),r=a(34),u=a(39),c=a(43),o=a(31),l=a(37),h=function(){function e(){Object(n.a)(this,e),this.database=void 0,this.auth=void 0,this.database=l.a.database(),this.auth=l.a.auth()}return Object(r.a)(e,[{key:"getUserChatRef",value:function(){return this.database.ref().child("userchats")}},{key:"getGroupChatRef",value:function(){return this.database.ref().child("/groupchats")}},{key:"getMessagePathToFriend",value:function(e){var t,a=(null===(t=this.auth.currentUser)||void 0===t?void 0:t.email)||"";return this.getUserChatRef().child(Object(o.b)(a,e)).child("/messages/")}},{key:"getMessageMetaDataPath",value:function(e){var t,a=(null===(t=this.auth.currentUser)||void 0===t?void 0:t.email)||"";return this.getUserChatRef().child(Object(o.b)(a,e)).child("/metaData/")}},{key:"getGroupPath",value:function(e){return this.getGroupChatRef().child(e).child("/messages/")}},{key:"getMessageMetaDataPathForGroup",value:function(e){return this.getGroupChatRef().child(e).child("/metaData/")}},{key:"getMessagesOnce",value:function(e,t){return this.getMessagePathToFriend(e).on(c.c,(function(a){return t(a,e)}),(function(e){}))}},{key:"getMessagesForGroup",value:function(e,t){this.getGroupPath(e).on("value",(function(a){return t(a,e)}))}},{key:"sendMessage",value:function(e,t){var a,n=(null===(a=this.auth.currentUser)||void 0===a?void 0:a.email)||"";return this.getMessagePathToFriend(e).update(Object(s.a)({},t.timestamp,Object(i.a)(Object(i.a)({},t),{},{from:n})))}},{key:"sendMessageToGroup",value:function(e,t){var a,n=(null===(a=this.auth.currentUser)||void 0===a?void 0:a.email)||"";return this.getGroupPath(e).update(Object(s.a)({},t.timestamp,Object(i.a)(Object(i.a)({},t),{},{from:n})))}},{key:"getLastMessage",value:function(e,t){return this.getMessagePathToFriend(e).orderByValue().limitToLast(1).on("value",(function(a){return t(e,a)}))}},{key:"getLastMessageOfGroup",value:function(e,t){return this.getGroupPath(e).orderByValue().limitToLast(1).on("value",(function(a){return t(e,a)}))}},{key:"getLastReadTime",value:function(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.h,s=Object(o.c)((null===(t=this.auth.currentUser)||void 0===t?void 0:t.email)||"");return a===u.h?this.getMessageMetaDataPath(e).child("lastMessageReadTime").child(s).get():a===u.c?this.getMessageMetaDataPathForGroup(e).child("lastMessageReadTime").child(s).get():void 0}},{key:"setLastReadTime",value:function(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.h,s=Object(o.c)((null===(t=this.auth.currentUser)||void 0===t?void 0:t.email)||"");return a===u.h?this.getMessageMetaDataPath(e).child("lastMessageReadTime").child(s).set((new Date).getTime()):a===u.c?this.getMessageMetaDataPathForGroup(e).child("lastMessageReadTime").child(s).set((new Date).getTime()):void 0}}]),e}()},51:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var s=a(65),i=a.n(s),n=function(e){return e?i()(new Date(e)).fromNow():null}},64:function(e,t,a){},76:function(e,t,a){"use strict";a.r(t);var s=a(36),i=a(32),n=a(0),r=a(50),u=(a(64),a(51)),c=a(35),o=a(3);t.default=function(e){var t=e.activeUser,a=e.activeGroup,l=Object(n.useState)([]),h=Object(i.a)(l,2),d=h[0],v=h[1],g=Object(n.useRef)({}),f=function(e){if(e.exists()){var t=e.val()||{};if(Object.keys(t).length>0){var a=Object.keys(t).map((function(e){return t[e]}));v(a.sort((function(e,t){return e.timestamp-t.timestamp})))}}};return Object(n.useEffect)((function(){v([]),function(){var e=new r.a;(null===t||void 0===t?void 0:t.email)?e.getMessagesOnce((null===t||void 0===t?void 0:t.email)||"",f):(null===a||void 0===a?void 0:a.id)&&e.getMessagesForGroup(a.id||"",f)}()}),[t,a]),Object(n.useEffect)((function(){var e;null===(e=document.querySelector("#activeMessage"))||void 0===e||e.scrollIntoView()}),[d]),Object(n.useEffect)((function(){var e=new c.a;g.current=Object(s.a)({},e.getCurrentUser())}),[]),Object(o.jsx)("div",{className:"messageWrapper",children:Object(o.jsx)("ul",{className:"messagesList",children:d.map((function(e,t){var a,s;return Object(o.jsxs)("li",{className:e.from!==(null===(a=g.current)||void 0===a?void 0:a.email)?"moveLeft":"moveRight",id:t===d.length-1?"activeMessage":"",children:[Object(o.jsx)("div",{className:e.from!==(null===(s=g.current)||void 0===s?void 0:s.email)?"sentByFriend":"sentByMe",children:e.message}),Object(o.jsx)("span",{className:"timeago",children:Object(u.a)(e.timestamp)})]},t)}))})})}}}]);
//# sourceMappingURL=11.6d19af1a.chunk.js.map